/**
Rule the words! KKuTu Online
Copyright (C) 2017 JJoriping(op@jjo.kr)

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program. If not, see <http://www.gnu.org/licenses/>.
*/


(function(){var h;var k=400;var l;$(document).ready(function(){h={list:$("#server-list"),total:$("#server-total"),start:$("#game-start"),ref:$("#server-refresh"),refi:$("#server-refresh>i")};$("#Background").attr('src',"").addClass("jt-image").css({'background-image':"url(/img/kkutu/gamebg.png)",'background-size':"200px 200px"});h.start.prop('disabled',true).on('click',function(e){var i,j;if($("#account-info").html()===L['LOGIN']){return $("#server-0").trigger('click')}for(i=0.9;i<1;i+=0.01){for(j in l){if(l[j]<i*k){$("#server-"+j).trigger('click');return}}}});h.ref.on('click',function(e){if(h.refi.hasClass("fa-spin")){return alert(L['serverWait'])}h.refi.addClass("fa-spin");setTimeout(seekServers,1000)});setInterval(function(){h.ref.trigger('click')},60000);seekServers()});function seekServers(){$.get("/servers",function(f){var g=0;h.list.empty();l=f.list;f.list.forEach(function(v,i){var a=(v===null)?"x":"o";var b=(a=="x")?"-":(v+" / "+k);var c=v/k*100;var d;g+=v||0;if(a=="o"){if(c>=99)a="q";else if(c>=90)a="p"}h.list.append(d=$("<div>").addClass("server").attr('id',"server-"+i).append($("<div>").addClass("server-status ss-"+a)).append($("<div>").addClass("server-name").html(L['server_'+i])).append($("<div>").addClass("server-people graph").append($("<div>").addClass("graph-bar").width(c+"%")).append($("<label>").html(b))).append($("<div>").addClass("server-enter").html(L['serverEnter'])));if(a!="x")d.on('click',function(e){location.href="/?server="+i});else d.children(".server-enter").html("-")});h.total.html("&nbsp;"+L['TOTAL']+" "+g+L['MN']);h.refi.removeClass("fa-spin");h.start.prop('disabled',false)})}})();